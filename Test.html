

LAN (Data 1) - 2001:49c8:1160:0300::/56

Loopback 10 - 2001:49c8:1160:030e::1/128

WAN/126 PE - 2001:49c8:1160:030f::1/126

WAN/126 CE - 2001:49c8:1160:030f::2/126
 
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 
1.       ########## CONFIGURE FORTIGATE REBOOT IN 15 MIN ##########

## Set cfg-save mode to ‘revert’ ##

## And set revert (reboot) timer to 15 minutes (default is 10 min) ##

#

conf global

conf system global

set cfg-save revert

set cfg-revert-timeout 900

end

end

#
 
2.       ########## CONFIGURE INTERFACES ##########

## Loopback Interface ##

#

config system interface

    edit "Loopback10"

        config ipv6

            set ip6-address 2001:49c8:1160:030e::1/128				<--- LOOPBACK 10

            set ip6-allowaccess ping https ssh snmp fgfm

        end

    next

end

#

## LAN Interface ##

#

config system interface

    edit internal1

        config ipv6

            set ip6-send-adv disable

            set autoconf disable

            set ip6-address 2001:49c8:1160:0300::1/64			<---- LAN (Data 1)

            set ip6-allowaccess ping

        end

    next

end

#

## WAN Interface ##

#

config system interface

    edit VLAN_801

        config ipv6

            set ip6-address 2001:49c8:1160:030f::2/126		<----- WAN/126 CE 

            set ip6-allowaccess ping

        end

    next

end

#
 
3.       ########## CONFIGURE PREFIX-LISTS ##########

## Inbound Prefix-List (Only allow default IPv6 route) ##

#

config router prefix-list6

    edit "IPv6-DEFAULT_ROUTE"

        set comments "INBOUND - Only allow default IPv6 route"

        config rule

            edit 5

                set prefix6 ::/0

                unset ge

                unset le

            next

        end

    next

end

#

## Outbound Prefix-List (prefix that was assigned to site) ##

#

config router prefix-list6

        edit PFX-FWS-GULFAL-LAN-V6

        set comments "OUTBOUND - Allow LAN prefix assigned to site"

        config rule

            edit 5

		set prefix6 2001:49c8:1160:0300::/56			<----- LAN (Data 1)

                unset ge

                unset le

            next

        end

    next

end

#
 
4.       ########## CONFIGURE ROUTE-MAPS ##########

## Inbound route-map ##

#

config router route-map

    edit VPNSv6_ING_VLAN_801

        set comments "IPv6 Inbound Route-Map"

        config rule

            edit 10

                set match-ip6-address "IPv6-DEFAULT_ROUTE"

            next

            edit 100

                set action deny

            next

        end

    next

end

#

## Outbound route-map ##

#

config router route-map

    edit VPNSv6_EGR_VLAN_801

        set comments "IPv6 Outbound Route-Map"

        config rule

            edit 10

                set match-ip6-address PFX-FWS-GULFAL-LAN-V6

                set set-community 50:801

            next

            edit 100

                set action deny

            next

        end

    next

end

#
 
5.       ########## CONFIGURE BGP ##########

## BGP IPv6 neighbors ##

#

config router bgp

    config aggregate-address6

        edit 1

	set prefix6 2001:49c8:1160:0300::/56			<---- LAN (Data 1) 

            set summary-only enable

        next

    end

config neighbor

    edit 2001:49c8:1160:030f::1						<--- PE WAN

        set soft-reconfiguration6 enable

        set remote-as 3549

        set route-map-in6 VPNSv6_ING_VLAN_801

        set route-map-out6 VPNSv6_EGR_VLAN_801

        set update-source VLAN_801

        set password 5CB60CDAE77980D14277994BBE961098

        set activate disable

    next

end

    config network6

        edit 1

            set prefix6 2001:49c8:1160:030e::1/128	<---- Loopback 10 

        next

    end

end

#

## BGP IPv4 neighbors ##

#

config router bgp

config neighbor

    edit 10.37.110.145

        set activate6 disable

    next

    edit 10.37.10.145

        set activate6 disable

        next

    end

end

#

## Show BGP neighbor received/advertised routes ##

#

get router info6 bgp neighbors 2001:49c8:1160:030f::1 received-routes

get router info6 bgp neighbors 2001:49c8:1160:030f::1 advertised-routes

get router info6 bgp neighbors 2001:49c8:1160:030f::1 routes

#
 
6.       ########## CONFIGURE POLICIES ##########

## IPv6 Address Objects ##

#

config firewall address6

    edit "DOI-ALL_2001:49c8::/32"

        set ip6 2001:49c8::/32

    next

end

config firewall addrgrp6

    edit "DOI-ALL"

        set member "DOI-ALL_2001:49c8::/32"

    next

end

## Policies ##

#

config firewall policy

#

    edit 0

        set status disable

        set name "CDM - MGMT Access Incoming – IPv6"

        set srcintf VLAN_60 VLAN_801

        set dstintf "Loopback10"

        set action accept

        set srcaddr6 "all"

        set dstaddr6 "all"

        set schedule "always"

        set service "ALL"

        set logtraffic all

    next

    edit 0

        set status disable

        set name "CDM - MGMT Access Incoming – IPv6"

        set srcintf "Loopback10"

        set dstintf VLAN_60 VLAN_801

        set action accept

        set srcaddr6 "all"

        set dstaddr6 "all"

        set schedule "always"

        set service "ALL"

        set logtraffic all

    next

    edit 0

        set status disable

        set name "CDM to DOI – IPv6"

        set srcintf VLAN_801

        set dstintf internal1

        set action accept

        set srcaddr6 "all"

        set dstaddr6 "all"

        set schedule "always"

        set service "ALL"

        set logtraffic all

    next    

    edit 0

        set status disable

        set name "DOI to CDM – IPv6"

        set srcintf internal1

        set dstintf VLAN_801

        set action accept

        set srcaddr6 "all"

        set dstaddr6 "all"

        set schedule "always"

        set service "ALL"

        set logtraffic all

    next

#

    edit 0

        set name "MGMT Access Incoming – IPv6"

        set srcintf VLAN_60 VLAN_801

        set dstintf "Loopback10"

        set action accept

        set srcaddr6 "DOI-ALL"

        set dstaddr6 "all"

        set schedule "always"

        set service "ALL"

        set logtraffic all

    next

    edit 0

        set name "MGMT Access Outgoing – IPv6"

        set srcintf "Loopback10"

        set dstintf VLAN_60 VLAN_801

        set action accept

        set srcaddr6 "all"

        set dstaddr6 "DOI-ALL"

        set schedule "always"

        set service "ALL"

        set logtraffic all

    next

    edit 0

        set name "MPLS to DOI – IPv6"

        set srcintf VLAN_801

        set dstintf internal1

        set action accept

        set srcaddr6 "DOI-ALL"

        set dstaddr6 "all"

        set schedule "always"

        set service "ALL"

        set logtraffic all

    next    

    edit 0

        set name "DOI to MPLS – IPv6"

        set srcintf internal1

        set dstintf VLAN_801

        set action accept

        set srcaddr6 "all"

        set dstaddr6 "all"

        set schedule "always"

        set service "ALL"

        set logtraffic all

    next

end

#
 
7.       ########## CANCEL FORTIGATE REBOOT ##########

## Set cfg-save mode back to ‘automatic’ ##

#

FWS-GULFAL # 

FWS-GULFAL # conf global
 
FWS-GULFAL (global) # execute cfg save

..config saved.
 
FWS-GULFAL (global) # conf system global
 
FWS-GULFAL (global) # set cfg-save automatic
 
FWS-GULFAL (global) # end
 
FWS-GULFAL (global) # end
 
FWS-GULFAL # 

FWS-GULFAL #
 
 
