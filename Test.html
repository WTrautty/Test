import pandas as pd
import matplotlib.pyplot as plt

# Load the Excel file
file_path = "your_excel_file.xlsx"  # <-- change this to your file
df = pd.read_excel(file_path, sheet_name='Sheet2', engine='openpyxl')

# Get the LEC Name column (column L is index 11)
lec_names = df.iloc[:, 11]

# Count occurrences of each unique LEC Name
lec_counts = lec_names.value_counts()

# Separate frequent and infrequent values
frequent = lec_counts[lec_counts > 5]
misc_count = lec_counts[lec_counts <= 5].sum()

# Combine into one Series for plotting
chart_data = frequent.copy()
chart_data["Misc."] = misc_count

# Create the pie chart
plt.figure(figsize=(8, 8))
plt.pie(chart_data, labels=chart_data.index, autopct='%1.1f%%', startangle=140)
plt.title("LEC Name Distribution (Grouped by Frequency)")
plt.tight_layout()
plt.show()
