import os

# === Configuration ===
input_dir = r'PUT\YOUR\FOLDER\PATH\HERE'

# === Traverse directory ===
for root, _, files in os.walk(input_dir):
    for file in files:
        if file.endswith(".txt"):
            file_path = os.path.join(root, file)
            with open(file_path, "r", encoding="utf-8", errors="ignore") as f:
                lines = f.readlines()

            modified = False
            new_lines = lines[:]

            for i in range(len(lines) - 1):
                if "CDM - MGMT Access Incoming - IPv6" in lines[i]:
                    if "Loopback10" in lines[i + 1]:
                        # Inline replacement preserving line structure
                        new_lines[i] = lines[i].replace("Incoming", "Outgoing")
                        modified = True

            if modified:
                with open(file_path, "w", encoding="utf-8") as f:
                    f.writelines(new_lines)
                print(f"[âœ”] Corrected: {file_path}")
