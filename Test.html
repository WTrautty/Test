import os
import glob
import pandas as pd

# Set the folder containing your CSV files
folder_path = r'C:\Users\AD39644\OneDrive - Lumen\Documents - USDA Site and SDWAN Device Details\CSVs'

# Get list of CSV files in the folder
csv_files = glob.glob(os.path.join(folder_path, "*.csv"))

if not csv_files:
    print("No CSV files found in folder:", folder_path)
else:
    print(f"Found {len(csv_files)} CSV file(s). Processing the first two.")

# Process only the first two CSV files
for file_path in csv_files[:2]:
    print(f"\nProcessing file: {os.path.basename(file_path)}")
    
    try:
        df = pd.read_csv(file_path)
        print("Data preview:")
        print(df.head(), "\n")
    except Exception as e:
        print(f"Could not read {file_path}: {e}")
        continue

    if len(df.columns) < 2:
        print("File does not have at least 2 columns.")
        continue

    key_col = df.columns[0]
    value_col = df.columns[1]
    matching_values = []

    for idx, row in df.iterrows():
        key = str(row[key_col]).strip()
        # Print the key for debugging purposes
        print(f"Row {idx}: key = '{key}'")
        
        # Check for our pattern
        if key.startswith("/1/vpn_lan_subif") and key.endswith("_name/interface/shutdown"):
            # Skip the exception key
            if key == "/1/vpn_lan_subif200_name/interface/shutdown":
                print("   Skipping exception key.")
                continue
            matching_values.append(row[value_col])
            print(f"   Found matching value: {row[value_col]}")
    
    if matching_values:
        if len(matching_values) >= 2:
            print("\nFirst matching value:", matching_values[0])
            print("Next matching value:", matching_values[1])
        else:
            print("\nOnly one matching value found:", matching_values[0])
    else:
        print("\nNo matching values found in this file.")

    print("-" * 40)
