# $language = "python"
# $interface = "1.0"

import os
import time

def main():
    # Prompt user for the full path to the command file.
    command_file = crt.Dialog.Prompt("Enter full path to command file:", "Command File", "", False)
    if not command_file:
        crt.Dialog.MessageBox("No file specified. Exiting.")
        return

    if not os.path.isfile(command_file):
        crt.Dialog.MessageBox("File not found: " + command_file)
        return

    try:
        file_handle = open(command_file, "r")
        content = file_handle.read()
        file_handle.close()
    except Exception as e:
        crt.Dialog.MessageBox("Error reading file: " + str(e))
        return

    # Split the file contents into commands using the delimiter "&new&".
    commands = [cmd.strip() for cmd in content.split("&new&") if cmd.strip()]

    # Iterate over the commands, sending each to the session.
    for cmd in commands:
        crt.Session.Output("Executing command: " + cmd + "\n")
        crt.Screen.Send(cmd + "\r")
        # Optionally, wait for the command to complete.
        # You might replace the fixed sleep with a wait for a known prompt:
        time.sleep(1)

main()
