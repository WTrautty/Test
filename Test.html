
# In get_all_orders(), modify the condition to ignore rows with an empty string or "0" in the order number
def get_all_orders():
    results = []
    for sheet_name, config in SEARCH_CONFIG.items():
        if sheet_name in wb_main.sheetnames:
            ws = wb_main[sheet_name]
            header_row, header_row_idx = find_header_row(ws)
            if not header_row:
                continue
            headers = {str(cell).replace('\n', ' '): idx for idx, cell in enumerate(header_row) if cell}
            search_cols = [header for header in headers 
                           if any(header.startswith(col) for col in config["search_columns"]) 
                           and header not in ["", "0"]]
            extract_cols = [header for header in headers if any(header.startswith(col) for col in config["extract_columns"])]
            for row in ws.iter_rows(min_row=header_row_idx + 1, values_only=True):
                for search_col in search_cols:
                    cell_val = row[headers[search_col]]
                    if cell_val is not None and str(cell_val).strip() not in ["", "0"]:
                        data = {col: row[idx] for col, idx in headers.items() if col in extract_cols}
                        results.append({"Sheet": sheet_name, "Data": data})
                        break
    return results

# In the main processing loop, check if the order number is empty or "0" before processing
for order in all_orders:
    try:
        data = order["Data"]
        # Get order number from "Ops Console Ticket"
        order_number = str(data.get("Ops Console Ticket", "")).strip()
        if order_number in ["", "0"]:
            continue  # Skip rows with an empty order number or "0"

        # ... rest of your processing logic ...

