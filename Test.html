template = template.replace('{Ops Console Ticket}', order_number)
        template = template.replace('{Region}', (ipv6_region if ipv6_region else "").strip)
        template = template.replace('{Lan (Data 1)}', (fixed_lan if fixed_lan else "").strip)
        template = template.replace('{WAN/126 CE}', (ce_wan if ce_wan else "").strip)
        template = template.replace('{WAN/126 CEnoSub}', (ce_wan.split('/')[0] if ce_wan else "").strip)
        template = template.replace('{md_pw}', (md_pw).strip)
        template = template.replace('{j_bar}', j_bar if j_bar else "")
        template = template.replace('{jRI}', jRI)
        template = template.replace('{vprn}', vprn)
        template = template.replace('{area}', area)
        template = template.replace('{IPv6_wan_noSub}', (data.get("IPv6 WAN", "").split('/')[0]).strip)
        template = template.replace('{IPv6_lan_noSub}', data.get("IPv6 LAN", "").split('/')[0])
        template = template.replace('{IPv6_lan_noSuband1}', data.get("IPv6 LAN", "").split('/')[0] + "1")
        template = template.replace('{IPv6_lan_Sub64and1}', data.get("IPv6 LAN", "").split('/')[0] + "1/64")
        template = template.replace('{IPv6_lan_and1}', data.get("IPv6 LAN", "").split('/')[0] + "1")
        template = template.replace('{WAN_CE}', data.get("IPv6 WAN", "").split('/')[0])
        template = template.replace('{Node_Only}', data.get("Node Name", "").split('.')[0])
        template = template.replace('{regional_vlan}', "80" + (ipv6_region if ipv6_region else ""))
        template = template.replace('{IPv6 Status}', data.get("IPv6 Status", ""))
        if data.get("IPv6 Loopback", ""):
            loopback_parts = data.get("IPv6 Loopback", "").split('/')
            if len(loopback_parts) > 1:
                template = template.replace('{IPv6 Loopback_andone}', loopback_parts[0] + "/" + loopback_parts[1])
        template = template.replace('{Service ID}', data.get("Service ID", ""))
        template = template.replace('{IPv6 WAN}', data.get("IPv6 WAN", ""))
        template = template.replace('{IPv6 LAN}', data.get("IPv6 LAN", ""))
        template = template.replace('{IPv6 Loopback}', data.get("IPv6 Loopback", ""))
        template = template.replace('{DOI_Bureau}', data.get("DOI_Bureau", ""))
        template = template.replace('{WHD_Location}', data.get("WHD_Location", ""))
        template = template.replace('{Node Name}', data.get("Node Name", ""))
        template = template.replace('{IP Address}', data.get("IP Address", ""))
        template = template.replace('{Address}', data.get("Address", ""))
        template = template.replace('{City}', data.get("City", ""))
        template = template.replace('{State}', data.get("State", ""))
        template = template.replace('{Vendor}', data.get("Vendor", ""))
        template = template.replace('{pe_type}', pe_type)
        template = template.replace('{WHD_Location_City}', (lambda m: m.group(1).replace('_', ' ') if m else '')(re.search(r'-(?P<group>[^-]*)-(?!.*-)', data.get("WHD_Location", " "))))

        # Replace new placeholders from LASER results
        template = template.replace('{default_interface}', default_interface)
        template = template.replace('{default_device}', default_device)
        template = template.replace('{default_scid}', default_scid)
        template = template.replace('{default_location}', default_location)
        template = template.replace('{default_wan_ip}', default_wan_ip)
        if default_wan_ip:
            wan_parts = default_wan_ip.split('/')[0].split('.')
            wan_parts[-1] = str(int(wan_parts[-1]) + 1)
            template = template.replace('{default_wan_ipand1}', '.'.join(wan_parts))
        else:
            template = template.replace('{default_wan_ipand1}', "")
        template = template.replace('{default_vrf}', default_vrf)
        if default_interface:
            template = template.replace('{def_int_noSub}', default_interface.split('.')[0])
        else:
            template = template.replace('{def_int_noSub}', "")
        template = template.replace('{t1_int}', default_interface.split('.')[0].replace(':', '.'))
