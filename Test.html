# ICMP check if second digit of ID is '1'
if icmp_check_required:
    for row_idx, row in df.iterrows():
        for col_idx, cell in enumerate(row):
            cell_value = str(cell).strip().lower()
            if cell_value == 'icmp':
                right = str(df.iloc[row_idx, col_idx + 1]).strip().upper() if col_idx + 1 < len(row) else ""
                below = str(df.iloc[row_idx + 1, col_idx]).strip().upper() if row_idx + 1 < len(df) else ""
                if right != "FALSE" and below != "FALSE":
                    candidate_details.append(
                        f"ICMP found at ({row_idx}, {col_idx}) with right='{right}' and below='{below}', neither is FALSE."
                    )
                    file_flagged = True
