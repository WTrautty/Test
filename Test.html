# $language = "python"
# $interface = "1.0"

import os
import time

def main():
    # Prompt the user for the full path to the command file.
    command_file = crt.Dialog.Prompt("Enter full path to command file:", "Command File", "", False)
    if not command_file:
        crt.Dialog.MessageBox("No file specified. Exiting.")
        return

    if not os.path.isfile(command_file):
        crt.Dialog.MessageBox("File not found: " + command_file)
        return

    try:
        file_handle = open(command_file, "r")
        content = file_handle.read()
        file_handle.close()
    except Exception as e:
        crt.Dialog.MessageBox("Error reading file: " + str(e))
        return

    # Split the file contents into commands using the delimiter "&new&".
    commands = [cmd.strip() for cmd in content.split("&new&") if cmd.strip()]

    # Iterate over the commands, sending each to the session.
    for cmd in commands:
        # Update the status bar with the command being executed.
        crt.Session.SetStatusText("Executing command: " + cmd)
        # Send the command followed by a carriage return.
        crt.Screen.Send(cmd + "\r")
        # Optionally, wait for the command to complete; adjust delay or implement wait-for-prompt as needed.
        time.sleep(1)

main()
