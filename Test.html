# === Pearson Coefficient per Month (Fully Safe) ===
pearson_labels = []
print("\n===== Pearson Coefficient Debugging =====")
for month in monthly_success_data.index:
    print(f"\nMonth: {month}")
    
    successes = monthly_success_data.loc[month].get("Successful", 0)
    total = monthly_success_data.loc[month].sum()

    print(f"Successes: {successes}, Total: {total}")
    
    if total <= 1:
        print(" -> Skipped (not enough data)")
        pearson_labels.append("r=n/a")
        continue

    x = [1] * successes + [0] * (total - successes)
    y = [1] * total

    print(f"x std: {np.std(x)}, y std: {np.std(y)}")

    if np.std(x) == 0 or np.std(y) == 0:
        print(" -> Skipped (x or y is constant)")
        pearson_labels.append("r=undefined")
    else:
        r, _ = pearsonr(x, y)
        print(f"Pearson r: {r}")
        pearson_labels.append(f"r={r:.2f}")
