import os
import glob
import pandas as pd

# Set the folder containing your CSV files
folder_path = r'C:\Users\AD39644\OneDrive - Lumen\Documents - USDA Site and SDWAN Device Details\CSVs'

# Get list of CSV files in the folder
csv_files = glob.glob(os.path.join(folder_path, "*.csv"))

# Process only the first two CSV files
for file_path in csv_files[:2]:
    print(f"Processing file: {os.path.basename(file_path)}")
    try:
        df = pd.read_csv(file_path)
    except Exception as e:
        print(f"Could not read {file_path}: {e}")
        continue

    if len(df.columns) < 2:
        print(f"File {os.path.basename(file_path)} does not have at least 2 columns.")
        continue

    key_col = df.columns[0]
    value_col = df.columns[1]
    
    # Collect values corresponding to matching keys
    matching_values = []
    for _, row in df.iterrows():
        key = str(row[key_col]).strip()
        # Check for our pattern
        if key.startswith("/1/vpn_lan_subif") and key.endswith("_name/interface/shutdown"):
            # Skip the exception key
            if key == "/1/vpn_lan_subif200_name/interface/shutdown":
                continue
            matching_values.append(row[value_col])
    
    if len(matching_values) >= 2:
        print(f"First matching value: {matching_values[0]}")
        print(f"Next matching value: {matching_values[1]}")
    elif len(matching_values) == 1:
        print(f"Only one matching value found: {matching_values[0]}. No next matching value available.")
    else:
        print("No matching values found.")
    
    print("-" * 40)
