for file_path in target_csv_files:
    try:
        # Try reading with UTF-8 encoding first; if that fails, try Latin-1.
        try:
            df = pd.read_csv(file_path, encoding='utf-8', header=None)
        except UnicodeDecodeError:
            df = pd.read_csv(file_path, encoding='latin1', header=None)
    except Exception as e:
        print(f"Error reading {file_path}: {e}")
        failed_files.append(f"Read Error: {os.path.basename(file_path)}\n{file_path}\nError: {e}\n")
        continue
