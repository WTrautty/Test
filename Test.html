# Prompt user for a specific order number
user_input_order = input("Enter the Ops Console Ticket number to process: ").strip()

# Find the matching order
matching_order = None
for order in all_orders:
    order_number = str(order["Data"].get("Ops Console Ticket", "")).strip()
    if order_number == user_input_order:
        matching_order = order
        break

if not matching_order:
    print(f"No matching order found for '{user_input_order}'.")
    exit()

# Open the LASER workbook
try:
    wb_laser = openpyxl.load_workbook(LASER_FILE, read_only=True)
except FileNotFoundError:
    print(f"Error [E002]: The LASER file '{LASER_FILE}' was not found. Please verify the file path and try again.")
    exit()

# Load the scheduler lookup if available
scheduler_lookup = {}
if os.path.exists(SCHEDULER_EXCEL):
    try:
        scheduler_df = pd.read_excel(SCHEDULER_EXCEL, sheet_name="IPV6", dtype=str)
        for idx, row in scheduler_df.iterrows():
            ticket = str(row.get("OPS Ticket#", "")).strip()
            scheduler_lookup[ticket] = {
                "Activation Technician": row.get("Activation Technician", "").strip() if pd.notnull(row.get("Activation Technician", "")) else "",
                "STATUS": row.get("STATUS", "").strip() if pd.notnull(row.get("STATUS", "")) else ""
            }
    except Exception as e:
        print(f"Error loading scheduler file: {e}")

# Load processed orders CSV
processed_orders = {}
if os.path.exists(PROCESSED_CSV):
    processed_df = pd.read_csv(PROCESSED_CSV, dtype=str)
    processed_orders = dict(zip(processed_df["Ops Console Ticket"], processed_df["order_hash"]))

# Define output directory
current_date = datetime.now().strftime("%Y-%m-%d")
output_directory = fr"C:\Users\AD39644\IPv6_Test_Files\{current_date}"
os.makedirs(output_directory, exist_ok=True)

# Now continue processing just the matching_order
order = matching_order
# (you can leave the rest of your original processing logic untouched here)
