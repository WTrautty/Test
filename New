    # === Line Chart: Monthly Failure Rate by Task Owner ===
    if "Task Owner" in df.columns and "Completed Date" in df.columns:
        owner_df = df[["Task Owner", "Is Fail", "Completed Date"]].copy()
        owner_df["Month"] = pd.to_datetime(owner_df["Completed Date"]).dt.to_period("M").astype(str)

        grouped_owner = (
            owner_df.groupby(["Task Owner", "Month"])
                .agg(Failure_Rate=("Is Fail", "mean"), Count=("Is Fail", "count"))
                .reset_index()
        )
        grouped_owner = grouped_owner[grouped_owner["Count"] > 2]
        grouped_owner["Failure_Rate"] = (grouped_owner["Failure_Rate"] * 100).round(1)

        if not grouped_owner.empty:
            owner_line_fig = px.line(
                grouped_owner,
                x="Month",
                y="Failure_Rate",
                color="Task Owner",
                markers=True,
                hover_data={"Task Owner": True, "Failure_Rate": True, "Count": True},
                title="Monthly Failure Rate by Task Owner"
            )
            owner_line_fig.update_layout(height=600, yaxis_title="Failure Rate (%)")
            task_owner_time_html = owner_line_fig.to_html(full_html=False, include_plotlyjs=False)
        else:
            task_owner_time_html = "<p><i>No sufficient monthly data to chart.</i></p>"
    else:
        task_owner_time_html = "<p><i>Task Owner or Completed Date column missing.</i></p>"
