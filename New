op_count = owner_df["Closure Code 1"].value_counts()
tp_count = top_df["Closure Code 1"].value_counts()
codes = sorted(set(op_count.index).union(tp_count.index))

op_count = op_count.reindex(codes, fill_value=0)
tp_count = tp_count.reindex(codes, fill_value=0)

pie_df = pd.DataFrame({
    "Closure Code 1": codes,
    "Count": op_count.values
})
pie_df["Owner %"] = pie_df["Count"] / pie_df["Count"].sum() * 100
