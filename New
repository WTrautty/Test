# Normalize bureau to handle extra spaces, lowercase, etc.
bureau_clean = (bureau or "").strip().upper()

if default_device.upper().startswith("ESP"):
    pe_type = "Alcatel"
    if device_vendor.upper().startswith("FORT"):
        template_path = r"C:\Users\AD39644\Service Information ESP FORT.txt"
    else:
        if "BOR" in bureau_clean:
            template_path = r"C:\Users\AD39644\Service Information ESP_BOR.txt"
        else:
            template_path = r"C:\Users\AD39644\Service Information ESP.txt"
else:
    pe_type = "Juniper"
    if default_interface.upper().startswith("LSQ"):
        if device_vendor.upper().startswith("FORT"):
            template_path = r"C:\Users\AD39644\Service Information Juno LSQ FORT.txt"
        else:
            if "BOR" in bureau_clean:
                template_path = r"C:\Users\AD39644\Service Information Juno LSQ_BOR.txt"
            else:
                template_path = r"C:\Users\AD39644\Service Information Juno LSQ.txt"
    else:
        if device_vendor.upper().startswith("FORT"):
            template_path = r"C:\Users\AD39644\Service Information Juno T1 FORT.txt"
        else:
            if "BOR" in bureau_clean:
                template_path = r"C:\Users\AD39644\Service Information Juno T1_BOR.txt"
            else:
                template_path = r"C:\Users\AD39644\Service Information Juno T1.txt"
