def main():
    # Load Excel data
    df = pd.read_excel(INPUT_FILE)

    if ERROR_COLUMN not in df.columns:
        raise ValueError(f"Column '{ERROR_COLUMN}' not found.")

    # Assign categories
    df["Category"] = df[ERROR_COLUMN].apply(assign_category)

    # Function to clean up sheet names
    def clean_sheet_name(name):
        invalid_chars = r'[]:*?/\\'
        for ch in invalid_chars:
            name = name.replace(ch, "")
        return name[:31]  # Excel max length

    # Write separate sheets
    with pd.ExcelWriter(OUTPUT_FILE, engine="openpyxl") as writer:
        for category in sorted(df["Category"].unique()):
            subset = df[df["Category"] == category].drop(columns=["Category"])
            sheet_name = clean_sheet_name(category)
            subset.to_excel(writer, sheet_name=sheet_name, index=False)

    print(f"Categorized file saved to '{OUTPUT_FILE}'.")
