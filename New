# Check month formatting
print("\n[DEBUG] Unique Month values:")
print(df["Month"].unique())

# Check monthly group counts
monthly_data = df.groupby("Month").agg(
    Fail_Rate=("Is Fail", "mean"),
    Order_Count=("Is Fail", "count")
).reset_index()

print("\n[DEBUG] Monthly Aggregated DataFrame:")
print(monthly_data)

# Check if Order_Count is constant
print("\n[DEBUG] Unique Order Counts per Month:")
print(monthly_data["Order_Count"].unique())

# Preview correlation inputs
print("\n[DEBUG] Pearson inputs:")
print("Order Counts:", monthly_data["Order_Count"].tolist())
print("Failure Rates:", monthly_data["Fail_Rate"].tolist())

# Check correlation result
if len(monthly_data["Order_Count"].unique()) > 1:
    volume_corr, volume_p = pearsonr(monthly_data["Order_Count"], monthly_data["Fail_Rate"])
    print(f"\n[DEBUG] Pearson Correlation: r={volume_corr:.3f}, p={volume_p:.4f}")
else:
    print("\n[DEBUG] Pearson Correlation skipped: constant Order_Count")
