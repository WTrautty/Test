# Prep base figure
total_monthly_fig = go.Figure()

# Add total line
total_df = sched.groupby("Month")["Count"].sum().reset_index(name="Total Rows")
total_monthly_fig.add_trace(
    go.Scatter(x=total_df["Month"], y=total_df["Total Rows"], name="Total", line=dict(width=3))
)

# Add each individual tab line
for tab, group in sched.groupby("Tab"):
    monthly = group.groupby("Month")["Count"].sum().reset_index()
    total_monthly_fig.add_trace(
        go.Scatter(x=monthly["Month"], y=monthly["Count"], name=tab, line=dict(dash="dot"))
    )

total_monthly_fig.update_layout(
    title="Total Rows Across All Tabs and Per Calendar",
    height=300
)
