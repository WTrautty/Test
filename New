def generate_sheet2_task_owner_pie():
    import pandas as pd
    import plotly.graph_objects as go

    try:
        df_sheet2 = pd.read_excel(EXCEL_PATH, sheet_name="Sheet2", engine="openpyxl")
    except Exception as e:
        return f"<div id='sheet2TaskOwnerTab' class='main-tab'><h2>Failed to load Sheet2: {e}</h2></div>"

    if "Task Owner" not in df_sheet2.columns:
        return "<div id='sheet2TaskOwnerTab' class='main-tab'><h2>'Task Owner' column not found in Sheet2.</h2></div>"

    task_owner_counts = df_sheet2["Task Owner"].dropna().value_counts()

    fig = go.Figure(data=[
        go.Pie(labels=task_owner_counts.index, values=task_owner_counts.values, hole=0.4)
    ])
    fig.update_layout(title="Task Owner Distribution (Sheet2)")

    return f'''
    <div id="sheet2TaskOwnerTab" class="main-tab">
        <h2>Task Owner Distribution from Sheet2</h2>
        {fig.to_html(include_plotlyjs=False, full_html=False)}
    </div>
    '''
